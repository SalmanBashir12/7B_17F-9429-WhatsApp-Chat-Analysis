---
title: "7B_17F-9429_WhatsApp Chat Analysis"
author: "Salman Bashir"
date: "12/10/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r}
install.packages("rwhatsapp")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("lubridate")
library(rwhatsapp)
library(dplyr)
library(ggplot2)
library(lubridate)
```
Loading dataset

```{r}
chat <- rwa_read("C:\\Users\\Hp\\Documents\\R\\7B_17F-9429-WhatsApp-Chat-Analysis\\WhatsApp Chat with Usama 17nu Cfd.txt") %>% 
  filter(!is.na(author)) # remove messages without author
chat


```
chat per day analysis with ggplot2

```{r}
library("ggplot2"); theme_set(theme_minimal())
chat %>%
  mutate(day = date()) %>%
  count(day) %>%
  ggplot(aes(x = day, y = n)) +
  geom_bar(stat = "identity") +
  ylab("") + xlab("") +
  ggtitle("Messages per day")


```
total messages 


```{r}
chat %>%
  mutate(day = date()) %>%
  count(author) %>%
  ggplot(aes(x = reorder(author, n), y = n)) +
  geom_bar(stat = "identity") +
  ylab("") + xlab("") +
  coord_flip() +
  ggtitle("Number of messages")



```
##most often used emojis
```{r}
library("tidyr")
chat %>%
  unnest(emoji) %>%
  count(author, emoji, sort = TRUE) %>%
  group_by(author) %>%
  top_n(n = 6, n) %>%
  ggplot(aes(x = reorder(emoji, n), y = n, fill = author)) +
  geom_col(show.legend = FALSE) +
  ylab("") +
  xlab("") +
  coord_flip() +
  facet_wrap(~author, ncol = 2, scales = "free_y")  +
  ggtitle("Most often used emojis")



```




## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
